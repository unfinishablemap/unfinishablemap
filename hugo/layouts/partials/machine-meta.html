<!-- JSON-LD Structured Data for Machine Consumption -->
{{- $ai := .Params.ai_contribution | default 0 -}}
{{- $type := cond (eq $ai 0) "human" (cond (eq $ai 100) "ai" "mixed") -}}
<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "name": "{{ .Title }}",
    "description": "{{ with .Description }}{{ . }}{{ else }}{{ .Site.Params.description }}{{ end }}",
    "url": "{{ .Permalink }}",
    "datePublished": "{{ .Date.Format "2006-01-02" }}",
    "dateModified": "{{ .Lastmod.Format "2006-01-02" }}",
    "author": {
        "@type": "{{ if eq $type "ai" }}Organization{{ else }}Person{{ end }}",
        {{ if eq $type "ai" }}
        "name": "{{ with .Params.ai_system }}{{ . }}{{ else }}AI System{{ end }}"
        {{ else if eq $type "human" }}
        "name": "{{ with .Params.author }}{{ . }}{{ else }}Unknown{{ end }}"
        {{ else }}
        "name": "Mixed ({{ $ai }}% AI)"
        {{ end }}
    },
    "creator": {
        "@type": "Organization",
        "name": "The Unfinishable Map",
        "url": "https://unfinishablemap.org"
    },
    {{ with .Params.concepts }}
    "keywords": [{{ range $i, $c := . }}{{ if $i }}, {{ end }}"{{ $c }}"{{ end }}],
    {{ end }}
    "publisher": {
        "@type": "Organization",
        "name": "{{ .Site.Title }}"
    },
    "sdPublisher": {
        "@type": "Organization",
        "name": "The Unfinishable Map"
    }{{ if or (eq $type "ai") (eq $type "mixed") }},
    "creditText": "{{ if eq $type "ai" }}AI-generated content under human supervision{{ else }}Human-AI collaborative content{{ end }}"{{ with .Params.last_curated }},
    "review": {
        "@type": "Review",
        "datePublished": "{{ . | time.Format "2006-01-02" }}",
        "author": {
            "@type": "Person",
            "name": "Human Editor"
        }
    }{{ end }}{{ end }}
}
</script>
